# \# 마스터 데이터 정의서: 가동률\_기준시간.xlsx

# 이 파일은 가동률 및 진료효율 계산을 위한 모든 매핑(Mapping) 기준을 담고 있는 마스터 데이터 시트입니다.

# 

# \## 1. \[기준시간] 시트

# 진료 항목별 표준 가동 시간을 계산하는 핵심 맵핑표입니다.

# \- \*\*No\*\*: 항목 번호

# \- \*\*대분류 / 소분류\*\*: 진료 항목의 분류 (보험/비보험 판별 기준)

# \- \*\*진료명\*\*: 엑셀 P열(진료내역)과 매칭할 키워드 (부분 일치 로직 적용)

# \- \*\*시술자\*\*: 해당 진료를 수행하는 주체 (원장/직원/공동)

# \- \*\*기본고정\*\*: 진료 1회당 발생하는 고정 시간 (분)

# \- \*\*분악당\*\*: 사분면(Quadrant)당 추가되는 가산 시간

# \- \*\*전치 / 소구치 / 대구치\*\*: 치아 부위별 개당 추가되는 가산 시간

# 

# \## 2. \[층별체어] 시트

# 엑셀 O열의 체어 명칭을 물리적 층수와 매핑합니다.

# \- \*\*구분\*\*: 체어 명칭 (예: 센터1, 1번, 소아실 등)

# \- \*\*층\*\*: 해당 체어가 위치한 층 (1층 또는 2층)

# &nbsp; - 1층: 센터1, 센터2, 센터3

# &nbsp; - 2층: 1번~6번, 소아실, 수술실

# 

# \## 3. \[요일별100%가동시간] 시트

# 가동률 계산의 분모가 되는 요일별 최대 가용 시간을 정의합니다.

# \- \*\*표 1: 요일별 100% 가동시간(분)\*\*

# &nbsp; - 행 구성: 합(전체), 1층, 2층

# &nbsp; - 열 구성: 월목금, 화, 수, 토 (요일별로 가용 시간이 다름)

# \- \*\*표 2: 요일별 100% 근무시간(분)\*\*

# &nbsp; - 총 근무 시간 기준 데이터

# 

# \## 4. \[직원목록] 시트

# 어시스트 직원의 정보를 관리합니다.

# \- \*\*no\*\*: 순번

# \- \*\*이름\*\*: 엑셀 N열(담당직원)과 매칭할 이름

# \- \*\*근무요일\*\*: 해당 직원의 기본 근무 형태

# 

# \## 5. \[원장목록] 시트

# 진료 의사의 정보를 관리합니다.

# \- \*\*no\*\*: 순번

# \- \*\*이름\*\*: 엑셀 M열(담당의사)과 매칭할 이름

# \- \*\*근무요일\*\*: 해당 원장의 진료 요일













\# 분석 엔진 설계도: 가동률\_기준시간.xlsx 데이터 활용 로직



이 파일은 접수수납목록 엑셀 데이터를 가공하여 최종 가동률 및 진료효율을 산출하는 데 사용되는 모든 '계산 기준'을 정의한다.



\## 1. \[기준시간] 시트: 진료 항목별 표준 소요시간 산출 로직

이 시트의 데이터는 환자별 '목표시간(AU열)'을 결정하는 핵심 변수다.



\- \*\*매칭 방식\*\*: P열(진료내역) 텍스트가 \[진료명(D열)] 문자열을 \*\*포함(Contains)\*\*하는지 검사한다.

\- \*\*계산 공식\*\*: 

&nbsp; `항목별 기준시간 = 기본고정(F) + (분악수 \* 분악당(G)) + (전치수 \* 전치(H)) + (소구치수 \* 소구치(I)) + (대구치수 \* 대구치(J))`

\- \*\*치식 파싱 규칙\*\*: 

&nbsp; 1. P열의 `#` 뒤에 오는 숫자를 FDI 치아 번호로 인식한다. 

&nbsp; 2. `~` 기호는 범위 내 모든 치아를 포함한다.

&nbsp; 3. 추출된 치아 번호를 부위별(전치/소구치/대구치) 및 분악별(10/20/30/40번대)로 카운트하여 공식의 변수로 대입한다.

\- \*\*예외 로직\*\*: G, H, I, J열의 값이 모두 0인 항목(예: 전악 치석제거)은 할당된 치아 번호가 있더라도 가산 없이 `기본고정(F)` 시간만 적용한다.



\## 2. \[층별체어] 시트: 공간 분리 분석 로직

데이터를 1층과 2층으로 그룹화하여 개별 통계를 내기 위해 사용한다.



\- \*\*매핑 방식\*\*: 접수수납 엑셀의 O열(체어) 텍스트를 이 시트의 \[구분(A열)]과 대조한다.

\- \*\*가공 목적\*\*: 

&nbsp; - 1층(센터1,2,3)과 2층(그 외)을 분류하여 '가동률\_결과저장' 시트의 \[3행(1층)]과 \[4행(2층)] 요약 테이블을 채우는 기준이 된다.

\- \*\*필터링\*\*: 매핑되지 않는 체어 명칭이 있을 경우 2층으로 기본 할당하되 로그를 남긴다.



\## 3. \[요일별100%가동시간] 시트: 가동률 분모(Capacity) 결정 로직

가동률(%)을 구하기 위한 분모값을 결정한다.



\- \*\*요일 인식\*\*: 분석 대상 파일명(예: ...20251223화.xlsx)에서 요일을 추출한다.

\- \*\*분모 매칭\*\*: 

&nbsp; - 전체 가동률 분모 = \[합] 행의 해당 요일 컬럼값.

&nbsp; - 1층 가동률 분모 = \[1층] 행의 해당 요일 컬럼값.

&nbsp; - 2층 가동률 분모 = \[2층] 행의 해당 요일 컬럼값.

\- \*\*계산 적용\*\*: `가동률 = (해당 그룹의 목표시간 합계 / 요일별 가용시간) \* 100`



\## 4. \[직원목록] 및 \[원장목록] 시트: 인적 효율 분석 로직

개인별 성과 지표를 산출하기 위해 사용한다.



\- \*\*매칭 방식\*\*: 

&nbsp; - 직원: 엑셀 N열(담당직원) ↔ \[직원목록]의 이름(B열).

&nbsp; - 원장: 엑셀 M열(담당의사) ↔ \[원장목록]의 이름(B열).

\- \*\*가공 목적\*\*: 

&nbsp; - '가동률\_결과저장' 시트 하단의 직원별/원장별 테이블 위치를 찾는 인덱스로 사용한다.

&nbsp; - 각 담당자별로 할당된 행의 실제 진료시간(AR열)과 목표시간(AU열)을 합산하여 개인별 진료효율을 계산한다.

\- \*\*근무요일 참조\*\*: 해당 날짜에 근무하는 인원임에도 데이터가 없을 경우 가동률 0%로 표시하기 위한 검증 데이터로 활용한다.



\## 5. 데이터 흐름 요약 (Data Flow)

1\. \*\*파일명\*\*에서 요일 및 날짜 추출 ➡️ \*\*\[요일별 가용시간]\*\* 확보.

2\. \*\*O열(체어)\*\* 확인 ➡️ \*\*\[층별체어]\*\* 매핑 ➡️ 1층/2층 그룹 할당.

3\. \*\*P열(진료내역)\*\* 분석 ➡️ \*\*\[기준시간]\*\* 맵핑표 대조 및 치식 계산 ➡️ \*\*목표시간(AU)\*\* 산출.

4\. \*\*M, N열(담당자)\*\* 확인 ➡️ \*\*\[원장/직원목록]\*\* 매핑 ➡️ 개인별 지표 합산.

5\. 모든 데이터를 합산하여 \*\*'가동률\_결과저장'\*\* 시트의 정해진 셀 주소에 배치 업데이트.

